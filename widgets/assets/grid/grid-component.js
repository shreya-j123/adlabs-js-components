class WgtGrid extends HTMLElement{constructor(){super(),this.items=[],this.played=!1,this.isRendered=!1,this.isCompleted=!1,this.adWidgetId=null,this.widgetId=null,this.widgetOrder=null}static get observedAttributes(){return["order","section_bg_color","logo_src","logo_position","headline","cta_text","cta_url","cta_position","items","item_border_color","item_bg_color","item_border_style","item_layout","item_animation","ad_widget_id","widget_id","paused"]}attributeChangedCallback(e,t,i){if(t!==i)switch(e){case"order":case"ad_widget_id":this.adWidgetId=i||null;break;case"widget_id":this.widgetId=i||null;break;case"section_bg_color":this.style.backgroundColor=i;break;case"items":try{this.items=JSON.parse(i)}catch(s){console.error("Invalid JSON in items attribute"),this.items=[]}this.render();break;case"logo_position":case"logo_src":case"headline":case"item_bg_color":case"item_border_color":case"item_border_style":case"item_layout":case"cta_text":case"cta_position":case"cta_url":case"item_animation":case"paused":this.render()}}connectedCallback(){this.resizeObserver=new ResizeObserver(()=>this.render()),this.resizeObserver.observe(this),this.render()}disconnectedCallback(){}getAttributeValue(e,t=""){let i=this.getAttribute(e);return null!==i?i:t}getOptimalColumns(e){return 1===e?1:2===e||4===e?2:3}render(){let e=this.items.length,t=this.clientWidth,i=this.clientHeight,s,r;t<250&&i/t>2.5?(s=1,r=e):t/i>1.2?(s=e,r=1):(s=this.getOptimalColumns(e),r=Math.ceil(e/s));let a=`grid-${Math.random().toString(36).substr(2,5)}`,d=this.getAttributeValue("item_border_color",""),l=this.getAttributeValue("item_bg_color",""),n=this.getAttributeValue("item_border_style",0),c=this.getAttributeValue("item_layout","1"),o=this.getAttributeValue("item_animation",""),h=this.getAttribute("logo_src"),g=this.getAttributeValue("logo_position","left"),m=this.getAttributeValue("headline",""),u=this.getAttribute("cta_text"),p=this.getAttributeValue("cta_position","left");this.getAttributeValue("cta_url","");let b=this.getAttributeValue("section_bg_color","transparent");this.adWidgetId=this.getAttribute("ad_widget_id")||a,this.widgetId=this.getAttribute("widget_id")||null,this.widgetOrder=this.getAttribute("order")||"Grid",this.setAttribute("id",this.widgetOrder);let y=h||m,w=!!u,C=y?10:0,v=w?10:0,A=document.createElement("div");if(A.className="wgt-grid-wrapper",A.style.backgroundColor=b,y){let $=document.createElement("div");if($.className="wgt-header",$.style.height=`${C}%`,$.style.flexDirection="right"===g?"row-reverse":"row",h){let f=document.createElement("img");f.src=h,f.className="wgt-logo",$.appendChild(f)}if(m){let k=document.createElement("h1");k.innerHTML=m,$.appendChild(k)}A.appendChild($)}let E=document.createElement("div");if(E.className="grid-container",E.style.height=`${100-C-v}%`,E.style.gridTemplateColumns=`repeat(${s}, 1fr)`,E.style.gridTemplateRows=`repeat(${r}, 1fr)`,this.items.forEach(e=>{let t=document.createElement("div");t.className="grid-item",(!this.hasAttribute("paused")||"false"===this.getAttribute("paused"))&&(t.classList.add(`animate-${o}`),this.played&&(t.classList.add(`animate-${o}`),t.style.animationDelay=`${.1*e.id}s`,t.style.animationFillMode="both"));let i=document.createElement("div");i.className="grid-itemChild",i.style.background=l,d&&(i.style.border=`1px solid ${d}`),i.style.borderRadius=n+"px";let s=document.createElement("div");e.cta_url&&s.addEventListener("click",()=>{AdEventTracker?.TrackingHelper?.triggerEvent?.({widgetId:this.widgetId,adWidgetId:this.adWidgetId,eventName:`ItemClick_${e.item_id??"unknown"}`,cumulative:!0,click:!0,engagement:!0})}),s.className="grid-content",s.style.flexDirection=c?"column":"column-reverse";let r=document.createElement("img");r.src=e.image_src||"",r.alt=e.item_id||"";let a=document.createElement("div");a.className="title",a.innerHTML=e.text||"",c?(s.appendChild(r),s.appendChild(a)):(s.appendChild(a),s.appendChild(r)),i.appendChild(s),t.appendChild(i),E.appendChild(t)}),A.appendChild(E),w){let _=document.createElement("div");_.className="wgt-ctaWrapper",_.style.height=`${v}%`,_.style.display="flex",_.style.alignItems="center",_.style.justifyContent="right"===p?"flex-end":"flex-start";let I=document.createElement("div");I.innerHTML=u,I.className="wgt-cta",I.style.paddingLeft="5px",I.style.paddingRight="5px",I.addEventListener("click",()=>{AdEventTracker?.TrackingHelper?.triggerEvent?.({widgetId:this.widgetId,adWidgetId:this.adWidgetId,eventName:"CTAClick",cumulative:!0,click:!0,engagement:!0})}),_.appendChild(I),A.appendChild(_)}this.innerHTML="",this.appendChild(A),this.isRendered||(this.dispatchEvent(new CustomEvent("wgt-rendered",{detail:{tag:this.tagName.toLowerCase()},bubbles:!0,composed:!0})),this.isRendered=!0),this.isRendered&&!this.isCompleted&&(this.dispatchEvent(new CustomEvent("wgt-completed",{detail:{tag:this.tagName.toLowerCase()},bubbles:!0,composed:!0})),this.isCompleted=!0)}play(){this.played||(this.played=!0,this.render())}destroy(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.items=[],this.played=!1,this.isRendered=!1,this.innerHTML=""}}customElements.define("wgt-grid",WgtGrid);