class WgtSlideCompare extends HTMLElement{constructor(){super(),this.isCompleted=!1,this.isRendered=!1,this.adWidgetId=null,this.widgetId=null,this.widgetOrder=null,this.moveSliderThumb=this.moveSliderThumb.bind(this),this.hasStarted=!1,this.hasCompleted=!1}static get observedAttributes(){return["order","before_src","after_src","slider_color","section_bg_color","ad_widget_id","widget_id"]}attributeChangedCallback(e,t,i){if(t!==i)switch(e){case"order":case"ad_widget_id":this.adWidgetId=i||null;break;case"widget_id":this.widgetId=i||null;break;case"section_bg_color":this.style.backgroundColor=i;break;case"before_src":case"after_src":this.play()}}connectedCallback(){this.resizeObserver=new ResizeObserver(()=>this.play()),this.resizeObserver.observe(this),this.play()}disconnectedCallback(){this.destroy()}getAttributeValue(e,t=""){let i=this.getAttribute(e);return null!==i?i:t}render(){let e=`grid-${Math.random().toString(36).substr(2,5)}`;this.adWidgetId=this.getAttribute("ad_widget_id")||e,this.widgetId=this.getAttribute("widget_id")||null,this.widgetOrder=this.getAttribute("order")||"SlideToCompare",this.setAttribute("id",this.widgetOrder);let t=this.getAttributeValue("section_bg_color","transparent"),i=this.getAttributeValue("before_src",""),a=this.getAttributeValue("after_src",""),r=this.getAttributeValue("slider_color","#CCCCCC"),s=document.createElement("div");s.classList.add("slide_compare_wrapper");let d=`image-comparison-range-${Math.random().toString(36).substr(2,5)}`,o=document.createElement("label");o.setAttribute("for",d),o.classList.add("image-comparison__label"),o.textContent="Move image comparison slider",s.appendChild(o);let l=document.createElement("input");l.type="range",l.min="0",l.max="100",l.value="0",l.id=d,l.setAttribute("data-image-comparison-range",""),l.classList.add("image-comparison__range"),s.appendChild(l);let n=document.createElement("div");n.classList.add("image-comparison__image-wrapper","image-comparison__image-wrapper--overlay","clipping"),n.setAttribute("data-image-comparison-overlay","");let m=document.createElement("figure");if(m.classList.add("image-comparison__figure"),a){let c=document.createElement("img");c.setAttribute("src",a),c.classList.add("image-comparison__image"),m.appendChild(c)}n.appendChild(m),s.appendChild(n);let g=document.createElement("div");g.classList.add("image-comparison__slider","sliding_animation"),g.style.backgroundColor=r,g.setAttribute("data-image-comparison-slider","");let h=document.createElement("span");h.style.backgroundColor=r,h.classList.add("image-comparison__thumb"),h.setAttribute("data-image-comparison-thumb",""),h.innerHTML='<svg class="image-comparison__thumb-icon" xmlns="https://www.w3.org/2000/svg" width="18" height="10" viewBox="0 0 18 10" fill="currentColor"> <path class="image-comparison__thumb-icon--left" d="M12.121 4.703V.488c0-.302.384-.454.609-.24l4.42 4.214a.33.33 0 0 1 0 .481l-4.42 4.214c-.225.215-.609.063-.609-.24V4.703z"></path> <path class="image-comparison__thumb-icon--right" d="M5.879 4.703V.488c0-.302-.384-.454-.609-.24L.85 4.462a.33.33 0 0 0 0 .481l4.42 4.214c.225.215.609.063.609-.24V4.703z"></path> </svg>',g.appendChild(h),s.appendChild(g);let p=document.createElement("div");p.classList.add("image-comparison__image-wrapper"),p.setAttribute("data-image-comparison-overlay","");let u=document.createElement("figure");if(u.classList.add("image-comparison__figure"),i){let b=document.createElement("img");b.setAttribute("src",i),b.classList.add("image-comparison__image"),u.appendChild(b)}p.appendChild(u),s.appendChild(p),this.innerHTML="",s.setAttribute("data-component","image-comparison-slider"),this.appendChild(s);let v=this.querySelector('[data-component="image-comparison-slider"]');this.init(v),requestAnimationFrame(()=>{let e=this.querySelector(".image-comparison__image-wrapper--overlay img"),i=this.querySelector(".image-comparison__image-wrapper:not(.image-comparison__image-wrapper--overlay) img");if(e&&i){let a=e.getBoundingClientRect(),r=i.getBoundingClientRect(),d=Math.max(a.width,r.width),o=Math.max(a.height,r.height);s&&d>0&&o>0&&(s.style.width=`${d}px`,s.style.height=`${o}px`),this.setBeforeBackgroundColor(t)}}),this.isRendered||(this.dispatchEvent(new CustomEvent("wgt-rendered",{detail:{tag:this.tagName.toLowerCase()},bubbles:!0,composed:!0})),this.isRendered=!0)}setSliderstate(e,t){let i=t.querySelector("[data-image-comparison-range]");if("input"===e.type){i.classList.add("image-comparison__range--active");return}i.classList.remove("image-comparison__range--active"),t.removeEventListener("mousemove",this.moveSliderThumb)}moveSliderThumb(e){this.querySelector(".image-comparison__slider")?.classList?.remove("sliding_animation"),this.querySelector(".image-comparison__image-wrapper--overlay")?.classList?.remove("clipping")}moveSliderRange(e,t){let i=e.target.value,a=t.querySelector("[data-image-comparison-slider]"),r=t.querySelector("[data-image-comparison-overlay]");a.style.left=`${i}%`,r.style.clipPath=`inset(0 ${100-i}% 0 0)`,t.addEventListener("mousemove",this.moveSliderThumb),this.setSliderstate(e,t),!this.hasStarted&&i>0&&i<25&&(this.hasStarted=!0,this.hasCompleted=!1,AdEventTracker?.TrackingHelper?.triggerEvent?.({widgetId:this.widgetId,adWidgetId:this.adWidgetId,eventName:"SlideStarted",cumulative:!0,click:!1,engagement:!0})),!this.hasCompleted&&i>=100&&(this.hasCompleted=!0,this.hasStarted=!1,AdEventTracker?.TrackingHelper?.triggerEvent?.({widgetId:this.widgetId,adWidgetId:this.adWidgetId,eventName:"SlideCompleted",cumulative:!0,click:!1,engagement:!0}))}setBeforeBackgroundColor(e){let t="dynamic-style-"+this.widgetOrder,i=document.getElementById(t);i||((i=document.createElement("style")).id=t,document.head.appendChild(i)),i.textContent=`
      #${this.widgetOrder} .image-comparison__figure::before {
        background-color: ${e} !important;
      }
    `}init(e){let t=e.querySelector("[data-image-comparison-range]");"ontouchstart"in window==!1&&(t.addEventListener("mouseup",t=>this.setSliderstate(t,e)),t.addEventListener("mousedown",this.moveSliderThumb)),t.addEventListener("pointerdown",this.moveSliderThumb),t.addEventListener("input",t=>this.moveSliderRange(t,e)),t.addEventListener("change",t=>this.moveSliderRange(t,e))}play(){this.render()}destroy(){this.remove()}destroy(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.isRendered=!1,this.innerHTML=""}}customElements.define("wgt-slide-compare",WgtSlideCompare);