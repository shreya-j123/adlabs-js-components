function getFrameOrientation(e){let t=document.querySelectorAll("ad-frame-deck");t.forEach(t=>{let{width:i,height:n}=t.getBoundingClientRect(),l=i/n>1.4?"orientation-landsc":"orientation-portrait";t.classList.remove("orientation-landsc","orientation-portrait"),t.classList.add(l),t.classList.add("is-ready"),adjustWidgetLayout(t,l,e)})}function setSize(e,t,i){null!=t&&(e.style.width="number"==typeof t?`${t}px`:t),null!=i&&(e.style.height="number"==typeof i?`${i}px`:i)}function isOverflowing(e,t,i){let n=e.getBoundingClientRect();if("orientation-landsc"===i){let l=t.reduce((e,t)=>{let i=window.getComputedStyle(t),n=parseFloat(i.marginLeft)||0,l=parseFloat(i.marginRight)||0;return e+t.getBoundingClientRect().width+n+l},0);return l>n.width}{let o=t.reduce((e,t)=>{let i=window.getComputedStyle(t),n=parseFloat(i.marginTop)||0,l=parseFloat(i.marginBottom)||0;return e+t.getBoundingClientRect().height+n+l},0);return o>n.height}}function forceEqualSplit(e,t,i){console.log(e),console.log(t),console.log(i);let n=e.getBoundingClientRect(),l=t.length;if("orientation-landsc"===i){let o=n.width/l;t.forEach(e=>setSize(e,o,"100%"))}else{let a=n.height/l;console.log(a),t.forEach(e=>setSize(e,"100%",a))}}function onVideoReady(e,t){e&&(e.readyState>=1?requestAnimationFrame(t):e.addEventListener("loadedmetadata",()=>{requestAnimationFrame(t)},{once:!0}))}function adjustWidgetLayout(e,t,i=[]){let n=Array.from(e.children).filter(e=>e.tagName.startsWith("WGT-")),l=n.filter(e=>!i.includes(e.tagName)),o=l.filter(e=>"WGT-VIDEO-PLAYER"===e.tagName),a=l.filter(e=>"WGT-INFO"===e.tagName),r=l.length,d=e.getBoundingClientRect();if(1===l.length){setSize(l[0],"100%","100%");return}if(1===o.length){let g=o[0],h=g.querySelector("video"),s=l.filter(e=>e!==g),$=a.length?a[0]:null,c=$?s.filter(e=>e!==$):s,u=()=>{let e=h.videoWidth,i=h.videoHeight;if("orientation-landsc"===t){let n=d.height*(e/i);setSize(g,n=Math.max(n=Math.min(n,.6*d.width),50),"100%");let l=d.width-n;r>2&&$&&(setSize($,"auto","100%"),l-=$.getBoundingClientRect().width);let o=l/c.length;c.forEach(e=>setSize(e,o,"100%"))}else{let a=h.videoHeight,s=h.videoWidth,u=d.width/(s/a);setSize(g,"100%",u=Math.min(u,.5*d.height));let f=d.height-u;if(r>2&&$){setSize($,"100%","auto"),requestAnimationFrame(()=>{let e=$.getBoundingClientRect().height;f-=e;let t=f/c.length;c.forEach(e=>setSize(e,"100%",t))});return}let m=f/c.length;c.forEach(e=>setSize(e,"100%",m))}};onVideoReady(h,()=>{u(),isOverflowing(e,l,t)&&forceEqualSplit(e,l,t)})}else if(o.length>0&&l.every(e=>"WGT-VIDEO-PLAYER"===e.tagName||"WGT-INFO"===e.tagName)){let f=a,m=o.length+f.length;if("orientation-landsc"===t){let S=[],E=[];o.forEach(e=>{let t=e.querySelector("video"),i=()=>{let i=t.videoWidth,n=t.videoHeight;if(n>i){let l=Math.max(d.height*(i/n),50);setSize(e,l,"100%"),S.push(e)}else E.push(e);if(S.length+E.length===o.length){let a=S.reduce((e,t)=>e+t.getBoundingClientRect().width,0),r=d.width-a,g=[...E,...f],h=r/g.length;g.forEach(e=>setSize(e,h,"100%"))}};onVideoReady(t,i)})}else{let _=d.height/m;l.forEach(e=>setSize(e,"100%",_))}}else{let z=a.length?a[0]:null,y=z?l.filter(e=>e!==z):l,R=new Set(y);if("orientation-landsc"===t){let v=0;o.forEach(e=>{let t=e.querySelector("video"),i=()=>{let i=t.videoWidth,n=t.videoHeight;if(n>i){let l=Math.max(d.height*(i/n),50);setSize(e,l,"100%"),v+=l,R.delete(e)}};onVideoReady(t,i)}),z&&(setSize(z,"auto","100%"),v+=z.getBoundingClientRect().width,R.delete(z));let w=d.width-v,C=w/R.size;R.forEach(e=>setSize(e,C,"100%"))}else if(z){setSize(z,"100%","auto");let W=z.getBoundingClientRect().height,T=d.height-W,p=T/y.length;y.forEach(e=>setSize(e,"100%",p))}else{let B=100/l.length;l.forEach(e=>setSize(e,"100%",`${B}%`))}}}(wow=new WOW({boxClass:"wow",animateClass:"animated",offset:0,mobile:!0,live:!0})).init(),excludedWidgetTags=["WGT-SCRATCH-CARD","WGT-PEEL","WGT-ONE-TAP-REMINDER"],window.addEventListener("load",()=>{getFrameOrientation(excludedWidgetTags),AdEventTracker?.initVisibilityObserver?.()});let resizeTimer;window.addEventListener("resize",()=>{clearTimeout(resizeTimer),resizeTimer=setTimeout(()=>{getFrameOrientation(excludedWidgetTags)},150)}),window.initDeck=function(){console.log("[frame-deck] initDeck() called");let e=document.querySelector("ad-frame-deck");if(!e){console.warn("No ad-frame-deck found in iframe");return}e.layout=()=>{console.log("[ad-frame-deck] manual layout triggered"),getFrameOrientation(excludedWidgetTags)},e.layout()};