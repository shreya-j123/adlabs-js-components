class SwipeLogoGallery extends HTMLElement{constructor(){super(),this.swiperInstance=null,this.items=[],this.viewedItems=new Set,this.isRendered=!1,this.isCompleted=!1,this.adWidgetId=null,this.widgetId=null,this.widgetOrder=null}static get observedAttributes(){return["order","section_bg_color","logo_position","logo_src","headline","item_bg_color","item_border_color","item_border_style","item_layout","items","ad_widget_id","widget_id","paused"]}attributeChangedCallback(e,t,i){if(t!==i)switch(e){case"order":case"ad_widget_id":this.adWidgetId=i||null;break;case"widget_id":this.widgetId=i||null;break;case"section_bg_color":this.style.backgroundColor=i;break;case"items":let s=[],r=[];try{r=JSON.parse(i),s=t?JSON.parse(t):[]}catch(a){console.error("Invalid JSON in items attribute"),r=[],s=[]}this.items=r,s.length;let l=r.length>0;l&&r.length>s.length?this.render():l&&r.length<s.length?this.render():l||this.destroy();break;case"logo_position":case"logo_src":case"headline":case"item_bg_color":case"item_border_color":case"item_border_style":case"item_layout":this.render();break;case"paused":this.isOverlayActive="true"===i,this.play()}}connectedCallback(){this.resizeObserver=new ResizeObserver(()=>this.render()),this.resizeObserver.observe(this),this.render()}disconnectedCallback(){}getAttributeValue(e,t=""){let i=this.getAttribute(e);return null!==i?i:t}render(){this.isRendered=!1;let e=this.clientWidth,t=this.clientHeight,i=`swiper-${Math.random().toString(36).substr(2,5)}`,s=this.getAttribute("logo_src"),r=this.getAttributeValue("logo_position","left"),a=this.getAttributeValue("headline",""),l=this.getAttributeValue("item_border_color",""),n=this.getAttributeValue("item_bg_color",""),d=this.getAttributeValue("item_border_style","0"),c=this.getAttributeValue("item_layout","1");if(this.adWidgetId||(this.adWidgetId=this.getAttribute("ad_widget_id")||i),this.widgetId=this.getAttribute("widget_id")||null,this.widgetOrder=this.getAttribute("order")||"SwiperGallery",this.setAttribute("id",this.widgetOrder),!this.items||0===this.items.length){this.destroy();return}let h=document.createElement("div");h.className="wgt-gallery-wrapper";let o=document.createElement("div");if(o.className="swiper-container",o.style.height=`${100-(a?20:0)}%`,a){let p=document.createElement("div");p.className="headline-wrapper",p.innerHTML=a,h.appendChild(p)}if(s){let g=document.createElement("div");g.className="logo-wrapper";let w=document.createElement("img");w.className="logo",w.src=s,w.alt="Logo",g.appendChild(w),o.appendChild(g),"right"!==r||o.classList.contains("row-reverse")||o.classList.add("row-reverse")}let m=document.createElement("div");m.className="swiper-wrapper-div",m.style.width=`${100-(s?20:0)}%`;let u=document.createElement("div");u.classList.add("swiper-wrapper");let b=1===this.items.length;if(this.items.forEach(i=>{let s=document.createElement("div");s.className="item-wrapper",s.classList.add("swiper-slide"),b&&s.classList.add("single-slide");let r=document.createElement("div");r.className="content-wrapper",r.setAttribute("item-id",i.item_id),r.style.backgroundColor=n,r.style.borderColor=l,r.style.borderRadius=d+"px",r.classList.remove("l-content","v-content"),r.classList.add(t<e?"l-content":"v-content"),i.cta_url&&r.addEventListener("click",()=>{AdEventTracker?.TrackingHelper?.triggerEvent?.({widgetId:this.widgetId,adWidgetId:this.adWidgetId,eventName:`ItemClick_${i.item_id??"unknown"}`,cumulative:!0,click:!0,engagement:!0})});let a=!!i.image_src,h=!!i.text;if(a){let o=document.createElement("div");o.className="image-block";let p=document.createElement("img");p.src=i.image_src,o.appendChild(p),r.appendChild(o),h&&r.classList.contains("v-content")&&(o.style.height="50%"),h&&r.classList.contains("l-content")&&(o.style.width="50%")}if(h){let g=document.createElement("div");g.className="text-content";let w=document.createElement("div");w.className="content-box",w.innerHTML=i.text,g.appendChild(w),r.appendChild(g),a&&r.classList.contains("v-content")&&(g.style.maxHeight="50%")}2==c&&(r.classList.contains("v-content")&&!r.classList.contains("col-reverse")?r.classList.add("col-reverse"):r.classList.contains("l-content")&&!r.classList.contains("row-reverse")&&r.classList.add("row-reverse")),s.appendChild(r),u.appendChild(s)}),!b){let v=document.createElement("div");v.className="swiper-button-next",m.appendChild(v)}m.appendChild(u),m.classList.add("swiper",`swiper-${i}`),o.appendChild(m),h.appendChild(o),this.innerHTML="",this.appendChild(h),b?this.swiperInstance=null:this.waitForStableSize(()=>{this.waitForSwiper(()=>{this.initSwiper(i)})})}initSwiper(e){if("undefined"==typeof Swiper){AdEventTracker?.ErrorLogger?.log?.("Swiper Gallery","Swiper container missing");return}let t=this.querySelector(`.swiper-${e}`),i=this.querySelector(".swiper-wrapper-div");if(!t||!i)return;let s=i.clientWidth,r;r=this.items.length>2?s<200?1:s>350?2:1.3:1,this.swiperInstance&&(this.swiperInstance.destroy(!0,!0),this.swiperInstance=null);try{let a=0;this.swiperInstance=new Swiper(t,{loop:!0,autoplay:{delay:2500,disableOnInteraction:!0,enabled:!1},slidesPerView:r,spaceBetween:10,navigation:{nextEl:this.querySelector(".swiper-button-next")},on:{init:e=>{this.dispatchRenderedEvent(),a=e.realIndex},touchEnd:e=>{Math.abs(e.touches.diff)&&AdEventTracker?.TrackingHelper?.triggerEvent?.({widgetId:this.widgetId,adWidgetId:this.adWidgetId,eventName:"Swiped",cumulative:!1,click:!1,engagement:!0})},slideChange:e=>{if(e.realIndex!==a){a=e.realIndex;let t=e.slides[e.activeIndex];if(!t)return;let i=t.querySelector(".content-wrapper");if(!i)return;let s=i.getAttribute("item-id");!s||this.viewedItems.has(s)||this.viewTracker(s)}}}})}catch(l){AdEventTracker?.ErrorLogger?.log?.("Swiper Gallery",l)}}viewTracker(e){this.viewedItems.add(e),AdEventTracker?.TrackingHelper?.triggerEvent?.({widgetId:this.widgetId,adWidgetId:this.adWidgetId,eventName:`ItemView_${e??"unknown"}`,cumulative:!1,click:!1,engagement:!1})}waitForSwiper(e,t=5){"undefined"!=typeof Swiper?e():t>0?setTimeout(()=>this.waitForSwiper(e,t-1),100):console.warn("Swiper not available after waiting")}waitForStableSize(e,t=5){let i=()=>{let s=this.clientWidth,r=this.clientHeight;s>0&&r>0?e():t>0?requestAnimationFrame(()=>setTimeout(i,50)):console.warn("wgt-swiper-gallery: failed to detect stable size")};i()}dispatchRenderedEvent(){this.isRendered||(this.isRendered=!0,this.dispatchEvent(new CustomEvent("wgt-rendered",{bubbles:!0,composed:!0,detail:{tag:this.tagName.toLowerCase()}})),!this.isRendered||this.isCompleted||(this.dispatchEvent(new CustomEvent("wgt-completed",{detail:{tag:this.tagName.toLowerCase()},bubbles:!0,composed:!0})),this.isCompleted=!0))}play(){if(this.hasAttribute("paused")&&"true"===this.getAttribute("paused"))this.swiperInstance.autoplay.stop();else{if(1===this.items.length&&this.items[0]&&!this.viewedItems.has(this.items[0].item_id)){let e=this.items[0].item_id;this.viewTracker(e)}this.swiperInstance&&this.swiperInstance.autoplay&&(console.log("autoplay"),this.swiperInstance.autoplay.start(),this.viewTracker(this.swiperInstance.activeIndex))}}pause(){this.swiperInstance&&this.swiperInstance.autoplay&&this.swiperInstance.autoplay.stop()}resume(){this.play()}destroy(){this.swiperInstance&&(this.swiperInstance.destroy(!0,!0),this.swiperInstance=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.items=[],this.viewedItems.clear(),this.isRendered=!1,this.innerHTML=""}}customElements.define("wgt-swiper-gallery",SwipeLogoGallery);